#!/bin/bash
# Simple wrapper for the safe cleanup utility

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
CLEANUP_SCRIPT="$SCRIPT_DIR/safe-cleanup.py"

# Default to dry-run mode for safety
if [ "$1" = "execute" ]; then
    echo "üßπ EXECUTING CLEANUP (files will be deleted after backup)"
    echo "Press Ctrl+C within 5 seconds to cancel..."
    sleep 5
    python3 "$CLEANUP_SCRIPT" --execute --log-level INFO
elif [ "$1" = "rollback" ]; then
    if [ -n "$2" ]; then
        echo "üîÑ ROLLING BACK from backup: $2"
        python3 "$CLEANUP_SCRIPT" --rollback "$2"
    else
        echo "üîÑ ROLLING BACK from latest backup"
        python3 "$CLEANUP_SCRIPT" --rollback ""
    fi
else
    echo "üîç ANALYZING potential test files (dry-run mode)"
    python3 "$CLEANUP_SCRIPT" --log-level INFO
    echo ""
    echo "To actually clean files: $0 execute"
    echo "To rollback cleanup: $0 rollback [timestamp]"
fi